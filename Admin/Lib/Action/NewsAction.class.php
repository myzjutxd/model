<?phpclass NewsAction extends BaseAction {	public function index() {		$M = new Model("newsview");		$list= $M->select();		$num = count($list);		for ($i = 0; $i < $num; $i++) {			if ($list["$i"]["IsShow"] == 1)				$list["$i"]["show"] = "yes";			else				$list["$i"]["show"] = "no";			if ($list["$i"]["IsTop"] == 1)				$list["$i"]["index"] = "yes";			else				$list["$i"]["index"] = "no";		}		$this -> assign("list", $list);		$this -> display();	}	public function edit() {		$id = $this -> _get("Id");		$classname = new Model("newsclass");		$list=$classname->select();		$this->assign("list",$list);		if ($id == null) {			$this -> display();		} else {			$M = new Model("news");			$data = $M -> where("Id=$id") -> find();			$this -> data = $data;			$this -> display();		}	}	public function save() {		$data = $this -> _post();        $data["UpdateTime"]=date ("Y-m-d h:m:s") ;		$data["Content"] =stripslashes($data["Content"]);		$M = new Model("news");		if ($data["Id"] == null) {			$M -> add($data);		} else {			$M -> save($data);		}		$this -> success("修改成功");	}	public function delete() {		$id = $this -> _get("Id");		$M = new Model("news");		$M -> where("Id=$id") -> delete();		$this -> success("删除成功");	}	public function IsShow() {		$id = $this -> _get("Id");		if ($id != null) {			$M = new Model("news");			$value = $M -> where("Id=$id") -> getField("IsShow");			if ($value == 1)				$value = 0;			else				$value = 1;			$data["IsShow"] = $value;			$data["Id"] = $id;			$M -> save($data);		}		$this -> success("操作成功");	}	public function IsTop() {		$id = $this -> _get("Id");		if ($id != null) {			$M = new Model("news");			$value = $M -> where("Id=$id") -> getField("IsTop");			if ($value == 1)				$value = 0;			else				$value = 1;			$data["IsTop"] = $value;			$data["Id"] = $id;			$M -> save($data);		}		$this -> success("操作成功");	}	public function update() {		$data = $this -> _post();		$M = new Model("news");		if ($data["Action"] == "update") {			$U["IsShow"] = $data["ChangeState"];			$D = $data["ListId"];			$num = count($D);			for ($i = 0; $i < $num; $i++) {				$U["Id"] = $D[$i];				$M -> save($U);			}		}		if ($data["Action"] == "delete") {			$D = $data["ListId"];			$num = count($D);			for ($i = 0; $i < $num; $i++) {				$id = $D[$i];				$M -> where("Id=$id") -> delete();			}		}		//echo $num;		//echo $U["IsShow"];		//$this->ajaxReturn($data);		$this -> success("操作成功");	}	//类别	public function classindex() {		$M = new Model("newsclass");		$list = $M -> select();		$this -> assign("list", $list);		$this -> display();	}	public function classedit() {		$id = $this -> _get("Id");		if ($id == null) {			$this -> display();		} else {			$M = new Model("newsclass");			$data = $M -> where("Id=$id") -> find();			$this -> data = $data;			$this -> display();		}	}	public function classsave() {		$data = $this -> _post();		$M = new Model("newsclass");		if ($data["Id"] == null) {			$M -> add($data);		} else {			$M -> save($data);		}		$this -> success("修改成功");	}	public function classdelete() {		$id = $this -> _get("Id");		$M = new Model("newsclass");		$M -> where("Id=$id") -> delete();		$this -> success("删除成功");	}}